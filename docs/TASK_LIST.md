# Ganoderma Papers RAG 系統建構任務

## 專案初始化
- [ ] 建立專案目錄結構
- [ ] 設定 Python 虛擬環境
- [ ] 安裝必要套件（PDF 處理、爬蟲、向量資料庫等）
- [ ] 建立 Docker Compose 配置

## 資料來源層 (Data Source)
- [ ] 開發靈芝新聞網論文連結爬蟲
  - [ ] 抓取**所有專欄**的文章（研究新知、靈芝調節免疫力、天選之材GMI 等）
  - [ ] 解析文章內容，提取論文原文連結
  - [ ] 智能過濾：只抓取包含學術論文引用的文章
  - [ ] 處理不同論文系統的連結（PubMed, PMC, arXiv 等）
  - [ ] 去重機制：避免重複抓取相同論文
- [ ] 建立 PDF 下載模組
  - [ ] 支援多種論文來源（PMC, PubMed, 其他期刊）
  - [ ] 本地儲存策略（預設）
  - [ ] 雲端儲存選項（AWS S3, Google Drive, Azure）
  - [ ] 處理下載失敗和重試機制（3 次重試）
  - [ ] PDF 完整性驗證
  - [ ] 儲存 PDF 到本地 `data/pdfs/` 目錄

## 資料處理管道 (Data Processing Pipeline)
- [ ] 開發 PDF 解析模組
  - [ ] 提取 PDF 文字內容
  - [ ] 保留論文結構（標題、摘要、章節）
  - [ ] 處理圖表和參考文獻
- [ ] 實作文本分塊 (Chunking) 策略
  - [ ] 按照論文章節智能分塊
  - [ ] 保留上下文資訊
- [ ] 建立 Embedding 生成模組
  - [ ] 使用 Jina Embeddings 或類似服務
  - [ ] 批次處理優化

## 儲存層 (Storage)
- [ ] 設定 PostgreSQL 資料庫
  - [ ] 設計論文元數據表結構
  - [ ] 儲存論文資訊、來源、作者等
- [ ] 設定 OpenSearch 向量資料庫
  - [ ] 建立索引結構
  - [ ] 儲存文本塊和向量

## Airflow 資料管道
- [ ] 建立每日同步 DAG
  - [ ] 定期抓取新論文
  - [ ] 自動下載和處理 PDF
  - [ ] 更新向量資料庫

## RAG 查詢系統
- [ ] 開發混合檢索管道
  - [ ] BM25 關鍵字搜尋
  - [ ] 向量相似度搜尋
  - [ ] 混合排序策略
- [ ] 整合 LLM (Ollama)
  - [ ] 設計專業文獻引用的 Prompt
  - [ ] 實作 Answer Generator
  - [ ] 提供引用格式（APA, MLA 等）

## API 層
- [ ] 建立 FastAPI 服務
  - [ ] `/ask-agentic` 端點（RAG 查詢）
  - [ ] `/restream` 端點（串流回應）
  - [ ] 非同步支援
- [ ] 實作 Redis 快取層

## 使用者介面
- [ ] 開發 Gradio 網頁介面
  - [ ] 問答輸入框
  - [ ] 顯示答案和來源引用
  - [ ] 顯示原始論文連結和 PDF

## 可觀測性 (Observability)
- [ ] 整合 Langfuse
  - [ ] 追蹤查詢記錄
  - [ ] Prompt 版本控制

## 測試與驗證
- [ ] 單元測試
- [ ] 整合測試
- [ ] 端到端測試
